-- For selected LOINC codes, and date range, retrieve diagnoses for analysis of empirical associations.
-- Only 'Final' diagnoses.
--
SELECT
	fe.encounter_id,
	fe.admitted_dt_tm,
	dlp.lab_procedure_id,
	dlp.lab_procedure_name,
	dlp.loinc_code,
	dd.diagnosis_id,
	dd.diagnosis_code,
	dd.diagnosis_type,
	dd.diagnosis_description
FROM
	hf_f_lab_procedure flp
JOIN
	hf_d_lab_procedure dlp ON dlp.lab_procedure_id = flp.detail_lab_procedure_id
JOIN
	hf_f_encounter fe ON fe.encounter_id = flp.encounter_id
JOIN
	hf_f_diagnosis fd ON fd.encounter_id = fe.encounter_id
JOIN
	hf_d_diagnosis dd ON dd.diagnosis_id = fd.diagnosis_id
JOIN
	hf_d_diagnosis_type ddt ON fd.diagnosis_type_id = ddt.diagnosis_type_id
WHERE
	ddt.diagnosis_type_display = 'Final'
WHERE
	DATE_PART('year',  fe.admitted_dt_tm) = 2022
	AND dlp.loinc_code IN (
	'1697-2',
	'1708-7',
	'1722-8',
	'1742-6',
	'1743-4',
	'1744-2',
	'1745-9',
	'1746-7',
	'1747-5',
	'1748-3',
	'1749-1',
	'1751-7',
	'1752-5',
	'1753-3',
	'1754-1',
	'1755-8',
	'1756-6',
	'1757-4',
	'1758-2',
	'1759-0',
	'1779-8',
	'1805-1',
	'1814-3',
	'1815-0',
	'1816-8',
	'1825-9',
	'1829-1',
	'1830-9',
	'1831-7',
	'1832-5',
	'1833-3',
	'1834-1',
	'1835-8',
	'1869-7',
	'1874-7',
	'1880-4',
	'1881-2',
	'1884-6',
	'1916-6',
	'1942-2',
	'1951-3',
	'1952-1',
	'1953-9',
	'1956-2',
	'1968-7',
	'1970-3',
	'1982-8',
	'1986-9',
	'1987-7',
	'1992-7',
	'2007-3',
	'2012-3',
	'2063-6',
	'2064-4',
	'2081-8',
	'2083-4',
	'2104-8',
	'2141-0',
	'2221-0',
	'2237-6',
	'2276-4',
	'2290-5',
	'2312-7',
	'2314-3',
	'2324-2',
	'2325-9',
	'2326-7',
	'2333-3',
	'2338-2',
	'2353-1',
	'2356-4',
	'2357-2',
	'2470-3',
	'2484-4',
	'2485-1',
	'2502-3',
	'2572-6',
	'2579-1',
	'2638-5',
	'2639-3',
	'2640-1',
	'2641-9',
	'2697-1',
	'2721-9',
	'2729-2',
	'2730-0',
	'2731-8',
	'2732-6',
	'2733-4',
	'2742-5',
	'2812-6',
	'2813-4',
	'2840-7',
	'2842-3',
	'2857-1',
	'2861-3',
	'2862-1',
	'2873-8',
	'2874-6',
	'2876-1',
	'2915-7',
	'2933-0',
	'2942-1',
	'2961-1',
	'2963-7',
	'2971-0',
	'3013-0',
	'3018-9',
	'3033-8',
	'3034-6',
	'3039-5',
	'3040-3',
	'3074-2',
	'3125-2',
	'3126-0',
	'3695-4',
	'4655-7',
	'6685-2',
	'6770-2',
	'6771-0',
	'6782-7',
	'6793-4',
	'6796-7',
	'6875-9',
	'6890-8',
	'6901-3',
	'6941-9',
	'6942-7',
	'9318-7',
	'9340-1',
	'9404-5',
	'9405-2',
	'9407-8',
	'9745-1',
	'9811-1',
	'9831-9',
	'10501-5',
	'10558-5',
	'10835-7',
	'10886-0',
	'10888-6',
	'10970-2',
	'11066-8',
	'11207-8',
	'11218-5',
	'12174-9',
	'12216-8',
	'12284-6',
	'12480-0',
	'12722-5',
	'12810-8',
	'12841-3',
	'12914-8',
	'12916-3',
	'12949-4',
	'13452-8',
	'13462-7',
	'13485-8',
	'13629-1',
	'13660-6',
	'13705-9',
	'13873-5',
	'13874-3',
	'13875-0',
	'13876-8',
	'13967-5',
	'13973-3',
	'13974-1',
	'13977-4',
	'13980-8',
	'13983-2',
	'13986-5',
	'13989-9',
	'13992-3',
	'13995-6',
	'14048-3',
	'14049-1',
	'14117-6',
	'14120-0',
	'14152-3',
	'14168-9',
	'14177-0',
	'14338-8',
	'14433-7',
	'14437-8',
	'14629-0',
	'14633-2',
	'14674-6',
	'14714-0',
	'14723-1',
	'14724-9',
	'14796-7',
	'14801-5',
	'14866-8',
	'14956-7',
	'14957-5',
	'14958-3',
	'14959-1',
	'15015-1',
	'15060-7',
	'15061-5',
	'15072-2',
	'15079-7',
	'15081-3',
	'15087-0',
	'15212-4',
	'15348-6',
	'15349-4',
	'16325-3',
	'16454-1',
	'17499-5',
	'17817-8',
	'17818-6',
	'17819-4',
	'17842-6',
	'17858-2',
	'18271-7',
	'19171-8',
	'19176-7',
	'19195-7',
	'20448-7',
	'20450-3',
	'20567-4',
	'20568-2',
	'20621-9',
	'21059-1',
	'21328-0',
	'21365-2',
	'22674-6',
	'22749-6',
	'23811-3',
	'23825-3',
	'24051-5',
	'24061-4',
	'24078-8',
	'24082-0',
	'24084-6',
	'24086-1',
	'24094-5',
	'24096-0',
	'24373-3',
	'25302-1',
	'25303-9',
	'25587-7',
	'25907-7',
	'26848-2',
	'26881-3',
	'27161-9',
	'27882-0',
	'27944-8',
	'29156-7',
	'29238-3',
	'29253-2',
	'29265-6',
	'29595-6',
	'29899-2',
	'29944-6',
	'29946-1',
	'30000-4',
	'30001-2',
	'30003-8',
	'30106-9',
	'30152-3',
	'30160-6',
	'30169-7',
	'30244-8',
	'30248-9',
	'30315-6',
	'30319-8',
	'30562-3',
	'30894-0',
	'30895-7',
	'31993-9',
	'32045-7',
	'32046-5',
	'32123-2',
	'32293-3',
	'32294-1',
	'32302-2',
	'32546-4',
	'32629-8',
	'32722-1',
	'32769-2',
	'33018-3',
	'33210-6',
	'33287-4',
	'33288-2',
	'33358-3',
	'33360-9',
	'33647-9',
	'33667-7',
	'33780-8',
	'33822-8',
	'33858-2',
	'33863-2',
	'33879-8',
	'33938-2',
	'33939-0',
	'34438-2',
	'34694-0',
	'35191-6',
	'35219-5',
	'35388-8',
	'35469-6',
	'35475-3',
	'35559-4',
	'35560-2',
	'35570-1',
	'35672-5',
	'35703-8',
	'35704-6',
	'35706-1',
	'35741-8',
	'38445-3',
	'38478-4',
	'38485-9',
	'38492-5',
	'38505-4',
	'38926-2',
	'40599-3',
	'40603-3',
	'40661-1',
	'40857-5',
	'41027-4',
	'41273-4',
	'41274-2',
	'42332-7',
	'42482-0',
	'42483-8',
	'42484-6',
	'42607-2',
	'42726-0',
	'42902-7',
	'42906-8',
	'43212-0',
	'43583-4',
	'43713-7',
	'43740-0',
	'43798-8',
	'43820-0',
	'43858-0',
	'43996-8',
	'43998-4',
	'44050-3',
	'44293-9',
	'44294-7',
	'44422-4',
	'44429-9',
	'44785-4',
	'44802-7',
	'44913-2',
	'44932-2',
	'45338-1',
	'46099-8',
	'46130-1',
	'46429-7',
	'46699-5',
	'46761-3',
	'47053-4',
	'47222-5',
	'47275-3',
	'47418-9',
	'47549-1',
	'47826-3',
	'47828-9',
	'47883-4',
	'48389-1',
	'48407-1',
	'48495-6',
	'48623-3',
	'48663-9',
	'48669-6',
	'48996-3',
	'49002-9',
	'49013-6',
	'49023-5',
	'49220-7',
	'49228-0',
	'49230-6',
	'49244-7',
	'49246-2',
	'49502-8',
	'49585-3',
	'49596-0',
	'49759-4',
	'49760-2',
	'49853-5',
	'49925-1',
	'49936-8',
	'50366-4',
	'50610-5',
	'50792-1',
	'50796-2',
	'50949-7',
	'51190-7',
	'51435-6',
	'51436-4',
	'51437-2',
	'51439-8',
	'51440-6',
	'51441-4',
	'51693-0',
	'51831-6',
	'53529-4',
	'53530-2',
	'53531-0',
	'53532-8',
	'53590-6',
	'53773-8',
	'53833-0',
	'53920-5',
	'53922-1',
	'53960-1',
	'53961-9',
	'53962-7',
	'54347-0',
	'54348-8',
	'54390-0',
	'54457-7',
	'55827-0',
	'55916-1',
	'55920-3',
	'55927-8',
	'55934-4',
	'56766-9',
	'56905-3',
	'56906-1',
	'57369-1',
	'57371-7',
	'57733-8',
	'58448-2',
	'59563-7',
	'59835-9',
	'60243-3',
	'61151-7',
	'61152-5',
	'62255-5',
	'62310-8',
	'62316-5',
	'62418-9',
	'62419-7',
	'62488-2',
	'63549-0',
	'66853-3',
	'67568-6',
	'68960-4',
	'69945-4',
	'69951-2',
	'70664-8',
	'72260-3',
	'72576-2',
	'72577-0',
	'72600-0',
	'72646-3',
	'73561-3',
	'73958-1',
	'74637-0',
	'74990-3',
	'75217-0',
	'75627-0',
	'75628-8',
	'75629-6',
	'75630-4',
	'75632-0',
	'76348-2',
	'76479-5',
	'76481-1',
	'76482-9',
	'76483-7',
	'76615-4',
	'76625-3',
	'76631-1',
	'76665-9',
	'77144-4',
	'77148-5',
	'78693-9',
	'78984-2',
	'78987-5',
	'80979-8',
	'81314-7',
	'81315-4',
	'81322-0',
	'82334-4',
	'82874-9',
	'83073-7',
	'83083-6',
	'83099-2',
	'83103-2',
	'83112-3',
	'83113-1',
	'83118-0',
	'88106-0',
	'89324-8',
	'90420-1',
	'90741-0',
	'90990-3',
	'92845-7',
	'93493-5',
	'94400-9',
	'94715-0',
	'94718-4',
	'95233-3')
	;
